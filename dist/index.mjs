import t from"fs";async function e(e={}){const{execaCommandSync:i}=await import("./index-e41ee275.js"),{extra:o=[]}=e,{env:n}=process;let l="";return{name:"vite-plugin-build-info-html",apply:"build",configResolved(t){l=`${t.root}/${t.build.outDir}/info.html`},closeBundle(){t.writeFile(l,function(){const t={projectName:e.projectName||n.npm_package_name,version:`v${n.npm_package_version}`,buildBranch:"",buildTime:(new Date).toLocaleString(),buildUser:n.USERNAME,buildUserEmail:"",lastCommitAuthor:"",lastCommitAuthorEmail:"",lastCommitter:"",lastCommitterEmail:"",lastCommitTime:"",lastCommitHash:""};try{i("git log -1"),Object.assign(t,{buildBranch:i("git rev-parse --abbrev-ref HEAD").stdout,buildUser:i("git config --get user.name").stdout,buildUserEmail:i("git config --get user.email").stdout,lastCommitAuthor:i('git log -1 --pretty=format:"%an"').stdout,lastCommitAuthorEmail:i('git log -1 --pretty=format:"%ae"').stdout,lastCommitter:i('git log -1 --pretty=format:"%cn"').stdout,lastCommitterEmail:i('git log -1 --pretty=format:"%ce"').stdout,lastCommitTime:i('git log -1 --pretty=format:"%ci"').stdout,lastCommitHash:i('git log -1 --pretty=format:"%H"').stdout})}catch(t){console.log("‚ú® [33m%s[0m","[vite-plugin-build-info-html] - You dont have git env!")}return o.forEach((({label:e,envKey:o,val:l,gitOrder:a})=>{l?t[e]=l:o?t[e]=n?.[o]:a&&(t[e]=i(a).stdout)})),`<!DOCTYPE html>\n        <html lang="zh-CN">\n            <head>\n                <meta charset="UTF-8" />\n                <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />\n                <title>build-info</title>\n            </head>\n            <body style="display:flex;justify-content: center; align-items:center; width: 90vw; padding: 20px;">\n                <noscript>\n                    <strong>\n                        We're sorry but html doesn't work properly without\n                        JavaScript enabled. Please enable it to continue.\n                    </strong>\n                </noscript>\n                <div>${Object.entries(t).map((([t,e])=>(console.log(t,e),`<div style="display:flex;">\n                        <div style="min-width:300px;">${t}: </div>\n                        <div style="font-weight;600; max-width:500px">${e.replace(/^"|"$/g,"")}</div>\n                    </div>\n                    <br/> `))).join("")}</div>\n            </body>\n        </html>\n        `}(),(t=>{t?console.log("‚ú® [31m%s[0m",`[vite-plugin-build-info-html] - ${t}`):console.log("‚ú® [32m%s[0m","[vite-plugin-build-info-html] - Generate successfullyÔºÅ")}))}}}export{e as buildInfo};
